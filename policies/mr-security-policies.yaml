filters:
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone production to-zone production address-book-global
    terms:
      - name: permit
        action: accept
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone production to-zone mgmt address-book-global
    terms:
      - name: monitoring--snmp
        source-address: netmon_group alert_group
        protocol: udp
        destination-port: SNMP
        action: accept
      - name: icmp
        source-address: netmon_group alert_group bast_group cumin_group prometheus_group
        protocol: icmp icmpv6
        action: accept
      - name: ssh
        source-address: netmon_group alert_group cumin_group bast_group prometheus_group
        protocol: tcp
        destination-port: SSH
        action: accept
      - name: dhcp
        source-address: install_group
        protocol: udp
        destination-port: DHCP
        action: accept
      - name: ipmitool
        source-address: cumin_group
        protocol: udp
        destination-port: IPMITOOL
        action: accept
      - name: idrac
        source-address: cumin_group
        protocol: tcp
        destination-port: IDRAC_KVM
        action: accept
      - name: webui
        source-address: cumin_group
        protocol: tcp
        destination-port: HTTP HTTPS
        action: accept
      - name: gnmi
        source-address: cumin_group
        protocol: tcp
        destination-port: SONIC_GNMI
        action: accept
      - name: prometheus
        source-address: prometheus_group
        protocol: tcp
        destination-port: Prometheus
        action: accept
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone mgmt to-zone production address-book-global
    terms:
      - name: any--ntp
        destination-port: NTP
        protocol: udp
        action: accept
      - name: any--dns
        destination-port: DNS
        protocol: udp tcp
        action: accept
      - name: any--syslog
        destination-port: SYSLOG SYSLOG_LOGSTASH
        protocol: udp
        action: accept
      - name: any--icmp
        protocol: icmp icmpv6
        action: accept
      - name: apt--web
        comment: |-
          To allow fetching Junos images
        destination-address: apt_group
        destination-port: WEB
        protocol: tcp
        action: accept
      - name: apt--httpalt
        comment: |-
          To allow fetching Junos images from 8080
        destination-address: apt_group
        destination-port: HTTP_ALT
        protocol: tcp
        action: accept
      - name: install--tftp
        comment: |-
          To allow fetching of ZTP shell script until http ready
        destination-address: install_group
        destination-port: TFTP
        protocol: udp
        action: accept
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone untrust to-zone junos-host address-book-global
    terms:
      - name: any--ssh
        destination-port: SSH
        protocol: tcp
        action: accept
      - name: any--icmp
        protocol: icmp icmpv6
        action: accept
      - name: any--traceroute
        destination-port: TRACEROUTE
        protocol: udp
        action: accept
      - name: default-deny
        comment: |-
          T218234 - to-zone junos-host has an implicit default permit
        action: deny
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone mgmt to-zone junos-host address-book-global
    terms:
      - name: any--traceroute
        destination-port: TRACEROUTE
        protocol: udp
        action: accept
      - name: any--icmp
        protocol: icmp icmpv6
        action: accept
      - name: any--ssh
        destination-port: SSH
        protocol: tcp
        action: accept
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone production to-zone junos-host address-book-global
    terms:
      - name: any--ospf
        protocol: ospf
        action: accept
      - name: any--bfd
        destination-port: BFD
        protocol: udp
        action: accept
      - name: infra--bgp
        source-address: network-infra
        destination-port: BGP
        protocol: tcp
        action: accept
      - name: any--traceroute
        destination-port: TRACEROUTE
        protocol: udp
        action: accept
      - name: any--icmp
        protocol: icmp icmpv6
        action: accept
      - name: any--ssh
        destination-port: SSH
        protocol: tcp
        action: accept
      - name: monitoring--snmp
        source-address: alert_group netmon_group
        destination-port: SNMP
        protocol: udp
        action: accept
      - name: default-deny
        comment: |-
          T218234 - to-zone junos-host has an implicit default permit
        action: deny
  - header:
      comment: |-
        Generated by Capirca
      targets:
        srx: from-zone all to-zone all address-book-global
    terms:
      - name: default-deny
        action: deny
        logging: "true"
