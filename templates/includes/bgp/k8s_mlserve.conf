{% for ipversion in [4, 6] %}
        replace: group Kubemlserve{{ ipversion }} {
            type external;
            multihop {
                ttl 2;
                /* T328523 */
                no-nexthop-change;
            }
            {% if metadata.role == 'cr' %}
            {% set ip_family = 'ip' + ipversion | string %}
            local-address {{ metadata[ip_family] }};
            {% endif %}
            hold-time 30;
            /* T328523 */
            advertise-peer-as;
            import kubemlserve_import;
            family inet{{ ipversion | trim('4') }} {
                unicast {
                    prefix-limit {
                        maximum 50;
                        teardown;
                    }
                }
            }
            /* T328523 */
            export kubernetes_export;
            peer-as {{ asns_mapping['k8s-mlserve'][metadata['site']] }};
            {% if l3_switch | d(false) %}
            local-as 14907 loops 2 private no-prepend-global-as;
            {% endif %}
            {% for hostname, ips in k8s_mlserve_neighbors.items() | sort() %}
            neighbor {{ ips[ipversion] }} {
                description {{ hostname }};
            }
            {% endfor %}
        }
{% endfor %}
